<html>
	<head>
		<style>
			body{
				background-color: 000099;
			}
			#scoreboard{
				background-color: black;
				position: absolute;
				color: white;
				text-align: center;
			}
			#spaceStart{
				background-color: black;
				position: absolute;
				bottom: 0;
				color: white;
				text-align: center;
				text-shadow: 0 0 15px rgba(255,255,255,.5), 0 0 10px rgba(255,255,255,.5);
			}
			#all{
				background-color: black;
				margin: auto;
				position: relative;
			}
			#rpad{
				background-color: white;
				width: 15px;
				margin-left: 780px;
				position: absolute;
			}
			#lpad{
				background-color: white;
				width: 15px;
				margin-left: 5px;
				position: absolute;
			}
			#ball{
				background-color: white;
				position: absolute;
				z-index: 2;
			}
			#borderHelper{
				border-right: dashed white 6px;
				position: absolute;
				z-index: 1;
			}
		</style>

		<script>
			var lMoveUp;
			var lMoveDown;
			var rMoveUp;
			var rMoveDown;
			var game_running;
			var interval;
			var lscore = 0;
			var rscore = 0;
			var game_speed = 7;
			var height = 120;
			var window_height = 600;
			var window_width = 800;
			var font_size = 200;
			var ball_size = 16;
			var scoreboard_height = 200;
			//ballMove 0=leftdown 1=leftup 2=rightup 3=rightdown
			var ballMove = Math.floor( Math.random() * 4 );
			var ballSpeed = 1;
			function starter(){
				document.getElementById("rpad").style.top = window_height/2 - height/2;
				document.getElementById("rpad").style.height = height;
				document.getElementById("lpad").style.top = window_height/2 - height/2;
				document.getElementById("lpad").style.height = height;
				
				document.getElementById( "ball" ).style.height = ball_size;
				document.getElementById( "ball" ).style.width = ball_size;
				
				document.getElementById( "all" ).style.height = window_height;
				document.getElementById( "all" ).style.width = window_width;
				
				document.getElementById( "borderHelper" ).style.height = window_height;
				document.getElementById( "borderHelper" ).style.width = window_width/2;
				
				document.getElementById( "spaceStart" ).style.width = window_width;
				document.getElementById( "spaceStart" ).style.fontSize = font_size /2;
				
				setBall();
				setScore();
			}
			function setScore(){
				document.getElementById( "scoreboard" ).style.width = window_width;
				document.getElementById( "scoreboard" ).style.fontSize = font_size;
				var score;
				if( lscore < 10 && rscore >= 10 ){
					score = 0+lscore + " " + rscore;
				}
				else if( lscore >= 10 && rscore < 10 ){
					score = lscore + " " + 0+rscore;
				}
				else{
					score = lscore + " " + rscore;
				}
				document.getElementById( "scoreboard" ).innerHTML = score;
			}
			function setBall(){
				document.getElementById("ball").style.top = window_height/2 - ball_size/2;
				document.getElementById("ball").style.left = window_width/2 - ball_size/2;
			}
			
			
			function endGame( playerThatLost ){
				if( playerThatLost == "left" ){
					rscore += 1;
				}
				else if( playerThatLost == "right" ){
					lscore += 1;
				}
				setBall();
				setScore();
			}
			
			
			
			function move(){
				
				//document.getElementById("rpad").style.top = parseInt(document.getElementById("rpad").style.top) - 5;
				//moving pads
				var rPosTop = parseInt(document.getElementById("rpad").style.top);
					if(rMoveUp == 1 && rPosTop>0) document.getElementById("rpad").style.top = rPosTop - 3;
					if(rMoveDown == 1 && rPosTop+height<600) document.getElementById("rpad").style.top = rPosTop + 3;
				
				var lPosTop = parseInt(document.getElementById("lpad").style.top);
					if(lMoveUp == 1 && lPosTop>0) document.getElementById("lpad").style.top = lPosTop - 3;
					if(lMoveDown == 1 && lPosTop+height<600) document.getElementById("lpad").style.top = lPosTop + 3;
				//movement pilki
				var ballPosTop = parseInt(document.getElementById("ball").style.top);
				var ballPosLeft = parseInt(document.getElementById("ball").style.left);
					if(ballMove == 0){ 
						document.getElementById("ball").style.top = ballPosTop + 1;
						document.getElementById("ball").style.left = ballPosLeft - 1;
					}
					if(ballMove == 1){ 
						document.getElementById("ball").style.top = ballPosTop - 1;
						document.getElementById("ball").style.left = ballPosLeft - 1;
					}
					if(ballMove == 2){ 
						document.getElementById("ball").style.top = ballPosTop - 1;
						document.getElementById("ball").style.left = ballPosLeft + 1;
					}
					if(ballMove == 3){ 
						document.getElementById("ball").style.top = ballPosTop + 1;
						document.getElementById("ball").style.left = ballPosLeft + 1;
					}
					//odbijanie od dolnej sciany
					if(ballMove == 0 && ballPosTop>585) ballMove = 1;
					if(ballMove == 1 && ballPosTop<0) ballMove = 0;
					//odbijanie od gornej sciany
					if(ballMove == 3 && ballPosTop>585) ballMove = 2;
					if(ballMove == 2 && ballPosTop<0) ballMove = 3;
					
					
					//odbijanie pilki od pads
					if(ballPosTop - 7 > lPosTop && ballPosTop + 8 < lPosTop + height && ballPosLeft < 22 && ballPosLeft > 17 && ballMove == 0) ballMove = 3;
					if(ballPosTop - 7 > lPosTop && ballPosTop + 8 < lPosTop + height && ballPosLeft < 22 && ballPosLeft > 17 && ballMove == 1) ballMove = 2;
					
					if(ballPosTop - 7 > rPosTop && ballPosTop + 8 < rPosTop + height && ballPosLeft > 767 && ballPosLeft < 772 && ballMove == 2) ballMove = 1;
					if(ballPosTop - 7 > rPosTop && ballPosTop + 8 < rPosTop + height && ballPosLeft > 767 && ballPosLeft < 772 && ballMove == 3) ballMove = 0;
					
					
					//obsluga przegrywania
					if( ballMove == 0 || ballMove == 1 ){
						if( ballPosLeft < 0 ){
							endGame( "left" );
						}
					}
					if( ballMove == 2 || ballMove == 3 ){
						if( ballPosLeft > window_width ){
							endGame( "right" );
						}
					}
					
					
				
				
			}
				
			function keyDownCheck(){
				//up arrow
				if(event.keyCode == 38){
					rMoveUp = 1;
				}
				//down arrow
				if(event.keyCode == 40){
					rMoveDown = 1;
				}
				//w
				if(event.keyCode == 87){
					lMoveUp = 1;
				}
				//s
				if(event.keyCode == 83){
					lMoveDown = 1;
				}		
			}
			
			function keyUpCheck(){
				//up arrow
				if(event.keyCode == 38){
					rMoveUp = 0;
				}
				//down arrow
				if(event.keyCode == 40){
					rMoveDown = 0;
				}
				//w
				if(event.keyCode == 87){
					lMoveUp = 0;
				}
				//s
				if(event.keyCode == 83){
					lMoveDown = 0;
				}		
			}
			
			
			// SPACE
			function keyPressCheck(){
				if( event.keyCode == 32 ){
				console.log( 1);
					if( game_running ){
						clearInterval( interval );
						game_running = false;
						document.getElementById( "spaceStart" ).style.display = "block";
					}
					else{
						interval = setInterval( move, game_speed );
						game_running = true;
						document.getElementById( "spaceStart" ).style.display = "none";
					}
				}
			}
			
		</script>
	</head>

	<body onKeyUp="keyUpCheck();" onKeyDown="keyDownCheck();" onkeypress = "keyPressCheck();" onLoad="starter();" >
	
		<div id="all">
			<div id = "borderHelper"></div>
			<div id = "spaceStart">SPACEBAR</div>
			<div id = "scoreboard"></div>
			<div id="rpad"></div>
			<div id="lpad"></div>
			<div id="ball"></div>
		</div>
	</body>
</html>